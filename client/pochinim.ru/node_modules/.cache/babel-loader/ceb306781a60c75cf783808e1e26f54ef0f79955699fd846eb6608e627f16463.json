{"ast":null,"code":"import{Fragment,useContext,useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import'./Chats.css';import{contextChats}from\"../../../contexts/contextChats\";import DotsImg from'../../../img/3-bots-img.png';import chatController from\"../../../controllers/Chat-controller\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Chats=_ref=>{let{idCompanion,idTopic}=_ref;const params=useParams();//const {chats, companionInfo} = useContext(idCompanion);\nconst[companionID,setCompanionID]=useState(idCompanion);const[messages,setMessages]=useState([]);const[message,setMessage]=useState('');useEffect(()=>{async function getData(){setMessages(await chatController.getMessagesUser(idTopic,companionID));};getData();});const enter=async()=>{if(message!=''){await chatController.sendMessageUser(message,companionID,idTopic);setMessage('');}};return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"opened-chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-head\",children:[/*#__PURE__*/_jsx(\"div\",{children:companionID}),/*#__PURE__*/_jsx(\"img\",{src:DotsImg,alt:\"\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-messages\",children:messages===null||messages===void 0?void 0:messages.map((val,ind)=>{if((val===null||val===void 0?void 0:val.sender_email)==params.email){var _val$message$split;return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'end'},children:/*#__PURE__*/_jsx(\"div\",{className:\"chat-my-message\",children:val===null||val===void 0?void 0:(_val$message$split=val.message.split(' '))===null||_val$message$split===void 0?void 0:_val$message$split.map((v,i)=>{return/*#__PURE__*/_jsx(\"p\",{children:v});})})},ind);}else{var _val$message$split2;return/*#__PURE__*/_jsx(\"div\",{className:\"chat-companion-message\",children:val===null||val===void 0?void 0:(_val$message$split2=val.message.split(' '))===null||_val$message$split2===void 0?void 0:_val$message$split2.map((v,i)=>{return/*#__PURE__*/_jsx(\"p\",{children:v});})},ind);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"text-input-field\",value:message,placeholder:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",onChange:e=>setMessage(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"button-grey\",onClick:()=>enter(),children:\"\\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]})});};export default Chats;","map":{"version":3,"names":["Fragment","useContext","useEffect","useState","useParams","contextChats","DotsImg","chatController","jsx","_jsx","jsxs","_jsxs","Chats","_ref","idCompanion","idTopic","params","companionID","setCompanionID","messages","setMessages","message","setMessage","getData","getMessagesUser","enter","sendMessageUser","children","className","src","alt","map","val","ind","sender_email","email","_val$message$split","style","display","justifyContent","split","v","i","_val$message$split2","value","placeholder","onChange","e","target","onClick"],"sources":["C:/Users/denis/VSCode_projects/Pochinim.ru/client/pochinim.ru/src/components/Pages/Chats/Chat.js"],"sourcesContent":["import { Fragment, useContext, useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport './Chats.css';\r\nimport { contextChats } from \"../../../contexts/contextChats\";\r\nimport DotsImg from '../../../img/3-bots-img.png';\r\nimport chatController from \"../../../controllers/Chat-controller\";\r\n\r\nconst Chats = ({idCompanion, idTopic}) => {\r\n\r\n    const params = useParams();\r\n\r\n    //const {chats, companionInfo} = useContext(idCompanion);\r\n\r\n    const [companionID, setCompanionID] = useState(idCompanion);\r\n    const [messages, setMessages] = useState([]);\r\n    const [message, setMessage] = useState('');\r\n\r\n    useEffect(()=>{\r\n        async function getData(){\r\n            setMessages(await chatController.getMessagesUser(idTopic, companionID));\r\n        };\r\n        \r\n        getData();\r\n    });\r\n\r\n    const enter = async () => {\r\n        if(message != ''){\r\n            await chatController.sendMessageUser(message, companionID, idTopic);\r\n            setMessage('');\r\n        }\r\n    }\r\n\r\n    return(<Fragment>\r\n                <div className=\"opened-chat\">\r\n                    <div className=\"chat-head\">\r\n                        <div>\r\n                            {companionID}\r\n                        </div>\r\n                        <img src={DotsImg} alt=\"\"></img>\r\n                    </div>\r\n                    <div className=\"chat-messages\">\r\n                        {messages?.map((val, ind) => {\r\n                            if(val?.sender_email == params.email){\r\n                                return(<div key={ind} style={{display: 'flex', justifyContent: 'end'}}>\r\n                                    <div className=\"chat-my-message\">\r\n                                        {val?.message.split(' ')?.map((v, i) => {\r\n                                            return(<p>{v}</p>);\r\n                                        })}\r\n                                        {/*<p>{val?.date}</p>*/}\r\n                                    </div>\r\n                                </div>);\r\n                            }else{\r\n                                return(<div key={ind} className=\"chat-companion-message\">\r\n                                        {val?.message.split(' ')?.map((v, i) => {\r\n                                            return(<p>{v}</p>);\r\n                                        })}\r\n                                        {/*<p>{val?.date}</p>*/}\r\n                                    </div>);\r\n                            }\r\n                        })}\r\n                    </div>\r\n                    <div className=\"chat-input\">\r\n                        <input className=\"text-input-field\" value={message} placeholder=\"Сообщение\" onChange={e => setMessage(e.target.value)}></input>\r\n                        <button className=\"button-grey\" onClick={() => enter()}>отправить</button>\r\n                    </div>\r\n                </div>\r\n    </Fragment>);\r\n}\r\n\r\nexport default Chats;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}