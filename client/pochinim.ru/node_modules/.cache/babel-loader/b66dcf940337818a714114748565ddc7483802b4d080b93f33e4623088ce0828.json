{"ast":null,"code":"import{makeAutoObservable}from\"mobx\";class MasterController{constructor(){makeAutoObservable(this);}async checkMasterInBd(email){return false;}async registrate(fio,occupation,workingFrom,location,selectedOptionsLocation,email,photo,password,city){var selectedOptionsLocationStr=[];if(selectedOptionsLocation!=null){for(const obj of selectedOptionsLocation){selectedOptionsLocationStr.push(obj.label);}}/*const id_master = await masterServices.registrate(fio, occupation, workingFrom, location, \r\n            JSON.stringify(selectedOptionsLocationStr).replace('[', '').replace(']', ''), \r\n            email, password, city);*/const body={\"fio\":fio,\"occupation\":occupation,\"workingFrom\":workingFrom,\"location\":location,\"selectedOptionsLocation\":JSON.stringify(selectedOptionsLocationStr).replace('[','').replace(']',''),\"email\":email,\"password\":password,\"city\":city};const data=await fetch(\"http://localhost:4000/api/masters\",{method:\"POST\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},credentials:'include',body:JSON.stringify(body)});const master=await data.json();localStorage.setItem('token-master',master===null||master===void 0?void 0:master.accessToken);localStorage.setItem('mail-master',email);const file=new FormData();file.append('masterPhoto',photo);const ret=await fetch(\"http://localhost:4000/api/masters/\".concat(master===null||master===void 0?void 0:master.id_master),{method:\"PUT\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},body:file});const bot=await data.json();//const ret = await masterServices.setMasterPhoto(id_master, photo);\nif(master!==null&&master!==void 0&&master.message||ret!==null&&ret!==void 0&&ret.message){return false;}return true;}async logInMaster(email,password){const body={'email':email,'password':password};const data=await fetch(\"http://localhost:4000/api/masters/login\",{method:\"POST\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},credentials:'include',body:JSON.stringify(body)});const ret=await data.json();localStorage.setItem('token-master',ret===null||ret===void 0?void 0:ret.accessToken);localStorage.setItem('mail-master',email);if(ret!==null&&ret!==void 0&&ret.message){return false;}return true;}async logOutMaster(){const data=await fetch(\"http://localhost:4000/api/masters/logout\",{credentials:'include',method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});const ret=await data.json();localStorage.removeItem('token-master');localStorage.removeItem('mail-master');if(ret!==null&&ret!==void 0&&ret.message){return false;}return true;}async refreshMasterTokens(){if(localStorage.getItem('token-master')){//const ret = await userServices.checkAuth();\nconst data=await fetch(\"http://localhost:4000/api/refresh-master\",{credentials:'include',method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});const ret=await data.json();localStorage.setItem('token-master',ret===null||ret===void 0?void 0:ret.accessToken);if(ret!==null&&ret!==void 0&&ret.message){return false;}else{return true;}}return false;}async getReviewsById(id){}async getWholeInfById(id){//const master = await masterServices.getMasterInfo(id);\nconst data=await fetch(\"http://localhost:4000/api/masters/\".concat(id),{method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});return await data.json();}async getListOfMasters(from,to){//const masters = await masterServices.getListOfMasters(from, to);\nconst data=await fetch(\"http://localhost:4000/api/masters/\".concat(from,\"/\").concat(to),{method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});const masters=await data.json();var fin=[];masters===null||masters===void 0?void 0:masters.map(obj=>{fin.push({'id':obj.id,'fio':obj.fio,'photo_path':obj.photo_path,'stars':obj.stars,'reviewsCount':obj.reviewsCount,'aboutMe':obj.aboutMe,'experience':obj.experience,'education':obj.education,'sercicesAndPrice':obj.sercicesAndPrice,'reviews':obj.reviews});});return fin;}async getMasterPhotoByPath(path){//const photo = await imageServices.getImageByPath(path);\nconst data=await fetch(\"http://localhost:4000/api/photos/\".concat(path),{method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});const photo=await data.blob();const obj=URL.createObjectURL(photo);return obj;}};const masterController=new MasterController();export default masterController;","map":{"version":3,"names":["makeAutoObservable","MasterController","constructor","checkMasterInBd","email","registrate","fio","occupation","workingFrom","location","selectedOptionsLocation","photo","password","city","selectedOptionsLocationStr","obj","push","label","body","JSON","stringify","replace","data","fetch","method","headers","credentials","master","json","localStorage","setItem","accessToken","file","FormData","append","ret","concat","id_master","bot","message","logInMaster","logOutMaster","removeItem","refreshMasterTokens","getItem","getReviewsById","id","getWholeInfById","getListOfMasters","from","to","masters","fin","map","photo_path","stars","reviewsCount","aboutMe","experience","education","sercicesAndPrice","reviews","getMasterPhotoByPath","path","blob","URL","createObjectURL","masterController"],"sources":["C:/Users/denis/VSCode_projects/Pochinim.ru/client/pochinim.ru/src/controllers/MASTER-controller.js"],"sourcesContent":["import {makeAutoObservable} from \"mobx\"\r\nclass MasterController{\r\n    constructor(){\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    async checkMasterInBd(email){\r\n        return false;\r\n    }\r\n\r\n    async registrate(fio, occupation, workingFrom, location, selectedOptionsLocation, \r\n                        email, photo, password, city){\r\n\r\n        var selectedOptionsLocationStr = [];\r\n        \r\n        if (selectedOptionsLocation != null) {\r\n            for (const obj of selectedOptionsLocation){\r\n                selectedOptionsLocationStr.push(obj.label)\r\n            }\r\n        }\r\n        \r\n        /*const id_master = await masterServices.registrate(fio, occupation, workingFrom, location, \r\n            JSON.stringify(selectedOptionsLocationStr).replace('[', '').replace(']', ''), \r\n            email, password, city);*/\r\n\r\n        const body = {\"fio\": fio, \"occupation\": occupation, \"workingFrom\": workingFrom, \"location\": location,\r\n                        \"selectedOptionsLocation\": JSON.stringify(selectedOptionsLocationStr).replace('[', '').replace(']', ''),\r\n                            \"email\": email, \"password\": password, \"city\": city};\r\n\r\n        const data = await fetch(`http://localhost:4000/api/masters`,{\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }, \r\n                credentials: 'include',\r\n                body: JSON.stringify(body)\r\n        });\r\n            \r\n        const master = await data.json();\r\n\r\n        localStorage.setItem('token-master', master?.accessToken);\r\n        localStorage.setItem('mail-master', email);\r\n\r\n        const file = new FormData();\r\n        file.append('masterPhoto', photo);\r\n\r\n        const ret = await fetch(`http://localhost:4000/api/masters/${master?.id_master}`,{\r\n                method: \"PUT\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                },\r\n                body: file\r\n        });\r\n\r\n        const bot = await data.json();\r\n        //const ret = await masterServices.setMasterPhoto(id_master, photo);\r\n        \r\n        if(master?.message || ret?.message){\r\n            return false;\r\n        }  \r\n        return true;\r\n    }\r\n\r\n    async logInMaster(email, password){\r\n        const body = {'email': email, 'password': password};\r\n\r\n        const data = await fetch(`http://localhost:4000/api/masters/login`,{\r\n                method: \"POST\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }, \r\n                credentials: 'include',\r\n                body: JSON.stringify(body)\r\n        });\r\n        \r\n        const ret = await data.json();\r\n\r\n        localStorage.setItem('token-master', ret?.accessToken);\r\n        localStorage.setItem('mail-master', email);\r\n        \r\n        if(ret?.message){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async logOutMaster(){\r\n        const data = await fetch(`http://localhost:4000/api/masters/logout`,{\r\n                credentials: 'include',\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }\r\n        });\r\n\r\n        const ret = await data.json();\r\n\r\n        localStorage.removeItem('token-master');\r\n        localStorage.removeItem('mail-master');\r\n\r\n        if(ret?.message){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async refreshMasterTokens(){\r\n        if(localStorage.getItem('token-master')){\r\n            //const ret = await userServices.checkAuth();\r\n            const data = await fetch(`http://localhost:4000/api/refresh-master`,{\r\n                credentials: 'include',\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }\r\n            })\r\n\r\n            const ret = await data.json();\r\n\r\n            localStorage.setItem('token-master', ret?.accessToken);\r\n\r\n            if(ret?.message){\r\n                return false;\r\n            }else{\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    async getReviewsById(id){\r\n        \r\n    }\r\n\r\n    async getWholeInfById(id){\r\n        //const master = await masterServices.getMasterInfo(id);\r\n        const data = await fetch(`http://localhost:4000/api/masters/${id}`,{\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }\r\n        });\r\n\r\n        return (await data.json());\r\n    }\r\n\r\n    async getListOfMasters(from, to){\r\n        //const masters = await masterServices.getListOfMasters(from, to);\r\n        const data = await fetch(`http://localhost:4000/api/masters/${from}/${to}`,{\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }\r\n        });\r\n\r\n        const masters = await data.json();\r\n\r\n        var fin = [];\r\n\r\n        masters?.map(obj => {\r\n            fin.push({\r\n                'id': obj.id,\r\n                'fio': obj.fio,\r\n                'photo_path': obj.photo_path,\r\n                'stars': obj.stars,\r\n                'reviewsCount': obj.reviewsCount,\r\n                'aboutMe': obj.aboutMe,\r\n                'experience': obj.experience,\r\n                'education': obj.education,\r\n                'sercicesAndPrice': obj.sercicesAndPrice,\r\n                'reviews': obj.reviews,\r\n            })\r\n        })\r\n\r\n        return fin;\r\n    }\r\n\r\n    async getMasterPhotoByPath(path){\r\n        //const photo = await imageServices.getImageByPath(path);\r\n        const data = await fetch(`http://localhost:4000/api/photos/${path}`,{\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }\r\n        })\r\n\r\n        const photo = await data.blob();\r\n\r\n        const obj = URL.createObjectURL(photo);\r\n\r\n        return obj;\r\n    }\r\n};\r\n\r\nconst masterController = new MasterController();\r\n\r\nexport default masterController;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}