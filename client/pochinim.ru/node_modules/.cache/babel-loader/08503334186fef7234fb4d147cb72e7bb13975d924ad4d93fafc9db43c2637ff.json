{"ast":null,"code":"import{Fragment,useContext,useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import'./Chats.css';import{contextChats}from\"../../../contexts/contextChats\";import DotsImg from'../../../img/3-bots-img.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Chats=()=>{const params=useParams();const CHATS=useContext(contextChats);const[chats,setChats]=useState(CHATS.chats);const[companionID,setCompanionID]=useState('');const[messages,setMessages]=useState([]);const[message,setMessage]=useState('');useEffect(()=>{async function getData(){await CHATS.downloadChatsOfTopic(CHATS.idTopic);setChats(CHATS.chats);await CHATS.downloadMessagesOfChat();setMessages(CHATS.messages);};getData();},[chats]);const enter=async()=>{CHATS.sendMessage(message);setMessage('');};return/*#__PURE__*/_jsx(Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"page-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"chats-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"messages-wrapper\",style:{width:'333px'},children:chats===null||chats===void 0?void 0:chats.map((val,ind)=>{return/*#__PURE__*/_jsxs(\"div\",{className:\"message-wrapper\",onClick:()=>{CHATS.idCompanion=val===null||val===void 0?void 0:val.id_master;},children:[/*#__PURE__*/_jsx(\"img\",{src:val===null||val===void 0?void 0:val.photo,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:val===null||val===void 0?void 0:val.id_master}),/*#__PURE__*/_jsx(\"p\",{children:val===null||val===void 0?void 0:val.text_of_last_message})]})]},ind);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"opened-chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-head\",children:[/*#__PURE__*/_jsx(\"div\",{children:companionID}),/*#__PURE__*/_jsx(\"img\",{src:DotsImg,alt:\"\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-messages\",children:messages===null||messages===void 0?void 0:messages.map((val,ind)=>{if((val===null||val===void 0?void 0:val.sender_email)==params.email){var _val$message$split;return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'end'},children:/*#__PURE__*/_jsx(\"div\",{className:\"chat-my-message\",children:val===null||val===void 0?void 0:(_val$message$split=val.message.split(' '))===null||_val$message$split===void 0?void 0:_val$message$split.map((v,i)=>{return/*#__PURE__*/_jsx(\"p\",{children:v});})})},ind);}else{var _val$message$split2;return/*#__PURE__*/_jsx(\"div\",{className:\"chat-companion-message\",children:val===null||val===void 0?void 0:(_val$message$split2=val.message.split(' '))===null||_val$message$split2===void 0?void 0:_val$message$split2.map((v,i)=>{return/*#__PURE__*/_jsx(\"p\",{children:v});})},ind);}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-input\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"text-input-field\",value:message,placeholder:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",onChange:e=>setMessage(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"button-grey\",onClick:()=>enter(),children:\"\\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})]})]})})});};export default Chats;","map":{"version":3,"names":["Fragment","useContext","useEffect","useState","useParams","contextChats","DotsImg","jsx","_jsx","jsxs","_jsxs","Chats","params","CHATS","chats","setChats","companionID","setCompanionID","messages","setMessages","message","setMessage","getData","downloadChatsOfTopic","idTopic","downloadMessagesOfChat","enter","sendMessage","children","className","style","width","map","val","ind","onClick","idCompanion","id_master","src","photo","alt","text_of_last_message","sender_email","email","_val$message$split","display","justifyContent","split","v","i","_val$message$split2","value","placeholder","onChange","e","target"],"sources":["C:/Users/denis/VSCode_projects/Pochinim.ru/client/pochinim.ru/src/components/Pages/Chats/Chats.js"],"sourcesContent":["import { Fragment, useContext, useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport './Chats.css';\r\nimport { contextChats } from \"../../../contexts/contextChats\";\r\nimport DotsImg from '../../../img/3-bots-img.png';\r\n\r\nconst Chats = () => {\r\n\r\n    const params = useParams();\r\n\r\n    const CHATS = useContext(contextChats);\r\n    const [chats, setChats] = useState(CHATS.chats);\r\n\r\n    const [companionID, setCompanionID] = useState('');\r\n    const [messages, setMessages] = useState([]);\r\n    const [message, setMessage] = useState('');\r\n\r\n    useEffect(()=>{\r\n        async function getData(){\r\n            await CHATS.downloadChatsOfTopic(CHATS.idTopic);\r\n            setChats(CHATS.chats);\r\n            await CHATS.downloadMessagesOfChat();\r\n            setMessages(CHATS.messages);\r\n        };\r\n\r\n        getData();\r\n    }, [chats]);\r\n\r\n    const enter = async () => {\r\n        CHATS.sendMessage(message);\r\n        setMessage('');\r\n    }\r\n\r\n    return(<Fragment>\r\n        <div className='page-wrapper'>\r\n            <div className=\"chats-content\">\r\n                    <div className=\"messages-wrapper\" style={{width: '333px'}}>\r\n                        {chats?.map((val, ind) => {\r\n                            return(<div key={ind} className=\"message-wrapper\" onClick={() => {CHATS.idCompanion = val?.id_master}}>\r\n                                <img src={val?.photo} alt=\"\"></img>\r\n                                <div> \r\n                                    <h1>{val?.id_master}</h1>\r\n                                    <p>{val?.text_of_last_message}</p>\r\n                                </div>\r\n                            </div>);\r\n                        })}\r\n                    </div>\r\n                <div className=\"opened-chat\">\r\n                    <div className=\"chat-head\">\r\n                        <div>\r\n                            {companionID}\r\n                        </div>\r\n                        <img src={DotsImg} alt=\"\"></img>\r\n                    </div>\r\n                    <div className=\"chat-messages\">\r\n                        {messages?.map((val, ind) => {\r\n                            if(val?.sender_email == params.email){\r\n                                return(<div key={ind} style={{display: 'flex', justifyContent: 'end'}}>\r\n                                    <div className=\"chat-my-message\">\r\n                                        {val?.message.split(' ')?.map((v, i) => {\r\n                                            return(<p>{v}</p>);\r\n                                        })}\r\n                                        {/*<p>{val?.date}</p>*/}\r\n                                    </div>\r\n                                </div>);\r\n                            }else{\r\n                                return(<div key={ind} className=\"chat-companion-message\">\r\n                                        {val?.message.split(' ')?.map((v, i) => {\r\n                                            return(<p>{v}</p>);\r\n                                        })}\r\n                                        {/*<p>{val?.date}</p>*/}\r\n                                    </div>);\r\n                            }\r\n                        })}\r\n                    </div>\r\n                    <div className=\"chat-input\">\r\n                        <input className=\"text-input-field\" value={message} placeholder=\"Сообщение\" onChange={e => setMessage(e.target.value)}></input>\r\n                        <button className=\"button-grey\" onClick={() => enter()}>отправить</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </Fragment>);\r\n}\r\n\r\nexport default Chats;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}