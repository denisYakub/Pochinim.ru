{"ast":null,"code":"import{makeAutoObservable}from\"mobx\";import userController from\"./USER-controller\";class TopicController{constructor(){makeAutoObservable(this);}async createNewTopic1(topic_name,fio,phoneNumber,need,problem,problem_location,address,date,_ref,_ref2,token){let{payment_option,priceStart,priceEnd}=_ref;let{details_text,details_files}=_ref2;const body={topic_name,fio,phoneNumber,need,problem,problem_location,address,date,payment_option,priceStart,priceEnd,details_text};const resultFromServer=await(await fetch(\"http://localhost:4000/api/topics\",{credentials:'include',method:'POST',headers:{\"Authorization\":\"Bearer \".concat(token),\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify(body)})).json();if(resultFromServer!==null&&resultFromServer!==void 0&&resultFromServer.id_topic){const files=new FormData();for(let i=0;i<details_files.length;i++){files.append('topicMainPhotos',details_files[i]);}await fetch(\"http://localhost:4000/api/topics/\".concat(id_topic),{method:\"PUT\",body:files});}else{return resultFromServer;}}async createNewTopic(_ref3){let{topic,FIO,phoneNumber,need,problem,problemLocation,address,date,paymentOption,priceStart,priceEnd,detailsText,detailsFiles}=_ref3;const body={\"topicName\":topic,\"fio\":FIO,\"phoneNumber\":phoneNumber,\"need\":need,\"problem\":problem,\"problemLocation\":problemLocation,\"address\":address,\"date\":date,\"payment\":paymentOption,\"priceStart\":priceStart,\"priceEnd\":priceEnd,\"detailsTxt\":detailsText,\"mail\":localStorage.getItem(\"mail\")};var dataTopic=await fetch(\"http://localhost:4000/api/topics\",{credentials:\"include\",method:\"POST\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(body)});if(dataTopic.status==401){await userController.refreshUserTokens();dataTopic=await fetch(\"http://localhost:4000/api/topics\",{credentials:\"include\",method:\"POST\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))},body:JSON.stringify(body)});}var id_topic;if(dataTopic.status==200){var _await$dataTopic$json;id_topic=(_await$dataTopic$json=await dataTopic.json())===null||_await$dataTopic$json===void 0?void 0:_await$dataTopic$json.id_topic;const files=new FormData();for(let i=0;i<detailsFiles.length;i++){files.append('topicMainPhotos',detailsFiles[i]);}await fetch(\"http://localhost:4000/api/topics/\".concat(id_topic),{method:\"PUT\",body:files});}return id_topic;}async getListOfExistingTopics(){const options=[\"Сантехник ремонт\",\"Сантехник ремонт стояка\",\"Сантехник онлайн\",\"Сантехник эксперт\",\"Сантехник срочно\"];return options;}async getListOfWork(){const options=[\"Срочная помощь при аварии\",\"Прочистка канализации\",\"Устранение течи\",\"Ремонт сантехники\",\"Установка или замена сантехники\",\"Демонтаж сантехники\",\"Дистанционная консульация сантехника\"];return options;}async getListOfWhatHappend(){const options=[\"Течь\",\"Засор\",\"Ржавчина\"];return options;}async getListofWhereIsProblem(){const options=[\"Трубы, соединения труб\",\"Унитаз\",\"Раковина, мойка\",\"Ванна\",\"Душевая кабина\",\"Полотенцесушитель\",\"Стояк\",\"Не знаю\"];return options;}};const topicController=new TopicController();export default topicController;","map":{"version":3,"names":["makeAutoObservable","userController","TopicController","constructor","createNewTopic1","topic_name","fio","phoneNumber","need","problem","problem_location","address","date","_ref","_ref2","token","payment_option","priceStart","priceEnd","details_text","details_files","body","resultFromServer","fetch","credentials","method","headers","concat","JSON","stringify","json","id_topic","files","FormData","i","length","append","createNewTopic","_ref3","topic","FIO","problemLocation","paymentOption","detailsText","detailsFiles","localStorage","getItem","dataTopic","status","refreshUserTokens","_await$dataTopic$json","getListOfExistingTopics","options","getListOfWork","getListOfWhatHappend","getListofWhereIsProblem","topicController"],"sources":["C:/Users/denis/VSCode_projects/Pochinim.ru/client/pochinim.ru/src/controllers/TOPIC-controller.js"],"sourcesContent":["import { makeAutoObservable } from \"mobx\";\r\nimport userController from \"./USER-controller\";\r\nclass TopicController{\r\n\r\n    constructor(){\r\n        makeAutoObservable(this)\r\n    }\r\n    async createNewTopic1(topic_name, fio, phoneNumber, need,\r\n            problem, problem_location, address, date,\r\n            {payment_option, priceStart, priceEnd}, {details_text, details_files}, token\r\n        ){\r\n            const body = {topic_name, fio, phoneNumber, need,\r\n                problem, problem_location, address, date,\r\n                payment_option, priceStart, priceEnd,\r\n                details_text\r\n            };\r\n            \r\n            const resultFromServer = await (await fetch(`http://localhost:4000/api/topics`,{\r\n                    credentials: 'include',\r\n                    method: 'POST',\r\n                    headers : {\r\n                    \"Authorization\": `Bearer ${token}`,\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                },\r\n                body: JSON.stringify(body)\r\n            })).json()\r\n            \r\n            if(resultFromServer?.id_topic){\r\n            \r\n                const files = new FormData();\r\n                \r\n                for(let i = 0; i < details_files.length; i++){\r\n                    files.append('topicMainPhotos', details_files[i]);\r\n                }\r\n                \r\n                await fetch(`http://localhost:4000/api/topics/${id_topic}`,{\r\n                    method: \"PUT\",\r\n                    body: files\r\n                });\r\n            }else{\r\n                return resultFromServer;\r\n            }\r\n        \r\n    }\r\n    async createNewTopic({topic, FIO, phoneNumber, need, problem, problemLocation,\r\n        address, date, paymentOption, priceStart, priceEnd, detailsText, detailsFiles}){\r\n        const body = {\"topicName\": topic, \"fio\": FIO, \"phoneNumber\": phoneNumber,\r\n                            \"need\": need, \"problem\": problem, \"problemLocation\": problemLocation,\r\n                            \"address\": address, \"date\": date, \"payment\":paymentOption, \r\n                            \"priceStart\": priceStart, \"priceEnd\": priceEnd,\r\n                            \"detailsTxt\": detailsText, \"mail\": localStorage.getItem(\"mail\")};\r\n\r\n        var dataTopic = await fetch(`http://localhost:4000/api/topics`, {\r\n            credentials: \"include\",\r\n            method: \"POST\", \r\n            headers : {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\",\r\n                \"Authorization\": `Bearer ${localStorage.getItem('token')}`\r\n            },\r\n            body: JSON.stringify(body)\r\n        });\r\n\r\n        if(dataTopic.status == 401){\r\n            await userController.refreshUserTokens();\r\n\r\n            dataTopic = await fetch(`http://localhost:4000/api/topics`, {\r\n                credentials: \"include\",\r\n                method: \"POST\", \r\n                headers : {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\",\r\n                    \"Authorization\": `Bearer ${localStorage.getItem('token')}`\r\n                },\r\n                body: JSON.stringify(body)\r\n            });\r\n        }\r\n\r\n        var id_topic;\r\n\r\n        if(dataTopic.status == 200){\r\n            id_topic = (await dataTopic.json())?.id_topic;\r\n            const files = new FormData();\r\n\r\n            for(let i = 0; i < detailsFiles.length; i++){\r\n                files.append('topicMainPhotos', detailsFiles[i]);\r\n            }\r\n                \r\n            await fetch(`http://localhost:4000/api/topics/${id_topic}`,{\r\n                method: \"PUT\",\r\n                body: files\r\n            });\r\n        }\r\n\r\n        return id_topic;\r\n    }\r\n\r\n    async getListOfExistingTopics(){\r\n        const options = [\"Сантехник ремонт\", \"Сантехник ремонт стояка\",\r\n                            \"Сантехник онлайн\", \"Сантехник эксперт\", \r\n                            \"Сантехник срочно\"];\r\n        return options;\r\n    }\r\n    \r\n    async getListOfWork(){\r\n        const options = [\"Срочная помощь при аварии\", \"Прочистка канализации\",\r\n                            \"Устранение течи\", \"Ремонт сантехники\", \r\n                            \"Установка или замена сантехники\", \"Демонтаж сантехники\",\r\n                            \"Дистанционная консульация сантехника\"];\r\n        return options;\r\n    }\r\n    \r\n    async getListOfWhatHappend(){\r\n        const options = [\"Течь\", \"Засор\", \"Ржавчина\"];\r\n        return options;\r\n    }\r\n    \r\n    async getListofWhereIsProblem(){\r\n        const options = [\"Трубы, соединения труб\", \"Унитаз\", \"Раковина, мойка\", \"Ванна\", \"Душевая кабина\",\r\n                            \"Полотенцесушитель\", \"Стояк\", \"Не знаю\"];\r\n        return options;\r\n    }\r\n};\r\n\r\nconst topicController = new TopicController();\r\n\r\nexport default topicController;"],"mappings":"AAAA,OAASA,kBAAkB,KAAQ,MAAM,CACzC,MAAO,CAAAC,cAAc,KAAM,mBAAmB,CAC9C,KAAM,CAAAC,eAAe,CAEjBC,WAAWA,CAAA,CAAE,CACTH,kBAAkB,CAAC,IAAI,CAAC,CAC5B,CACA,KAAM,CAAAI,eAAeA,CAACC,UAAU,CAAEC,GAAG,CAAEC,WAAW,CAAEC,IAAI,CAChDC,OAAO,CAAEC,gBAAgB,CAAEC,OAAO,CAAEC,IAAI,CAAAC,IAAA,CAAAC,KAAA,CAC+BC,KAAK,CAC/E,IADG,CAACC,cAAc,CAAEC,UAAU,CAAEC,QAAQ,CAAC,CAAAL,IAAA,IAAE,CAACM,YAAY,CAAEC,aAAa,CAAC,CAAAN,KAAA,CAErE,KAAM,CAAAO,IAAI,CAAG,CAAChB,UAAU,CAAEC,GAAG,CAAEC,WAAW,CAAEC,IAAI,CAC5CC,OAAO,CAAEC,gBAAgB,CAAEC,OAAO,CAAEC,IAAI,CACxCI,cAAc,CAAEC,UAAU,CAAEC,QAAQ,CACpCC,YACJ,CAAC,CAED,KAAM,CAAAG,gBAAgB,CAAG,KAAM,CAAC,KAAM,CAAAC,KAAK,oCAAoC,CACvEC,WAAW,CAAE,SAAS,CACtBC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAG,CACV,eAAe,WAAAC,MAAA,CAAYZ,KAAK,CAAE,CAClC,QAAQ,CAAE,kBAAkB,CAC5B,cAAc,CAAE,kBACpB,CAAC,CACDM,IAAI,CAAEO,IAAI,CAACC,SAAS,CAACR,IAAI,CAC7B,CAAC,CAAC,EAAES,IAAI,CAAC,CAAC,CAEV,GAAGR,gBAAgB,SAAhBA,gBAAgB,WAAhBA,gBAAgB,CAAES,QAAQ,CAAC,CAE1B,KAAM,CAAAC,KAAK,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAE5B,IAAI,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGd,aAAa,CAACe,MAAM,CAAED,CAAC,EAAE,CAAC,CACzCF,KAAK,CAACI,MAAM,CAAC,iBAAiB,CAAEhB,aAAa,CAACc,CAAC,CAAC,CAAC,CACrD,CAEA,KAAM,CAAAX,KAAK,qCAAAI,MAAA,CAAqCI,QAAQ,EAAG,CACvDN,MAAM,CAAE,KAAK,CACbJ,IAAI,CAAEW,KACV,CAAC,CAAC,CACN,CAAC,IAAI,CACD,MAAO,CAAAV,gBAAgB,CAC3B,CAER,CACA,KAAM,CAAAe,cAAcA,CAAAC,KAAA,CAC+D,IAD9D,CAACC,KAAK,CAAEC,GAAG,CAAEjC,WAAW,CAAEC,IAAI,CAAEC,OAAO,CAAEgC,eAAe,CACzE9B,OAAO,CAAEC,IAAI,CAAE8B,aAAa,CAAEzB,UAAU,CAAEC,QAAQ,CAAEyB,WAAW,CAAEC,YAAY,CAAC,CAAAN,KAAA,CAC9E,KAAM,CAAAjB,IAAI,CAAG,CAAC,WAAW,CAAEkB,KAAK,CAAE,KAAK,CAAEC,GAAG,CAAE,aAAa,CAAEjC,WAAW,CACpD,MAAM,CAAEC,IAAI,CAAE,SAAS,CAAEC,OAAO,CAAE,iBAAiB,CAAEgC,eAAe,CACpE,SAAS,CAAE9B,OAAO,CAAE,MAAM,CAAEC,IAAI,CAAE,SAAS,CAAC8B,aAAa,CACzD,YAAY,CAAEzB,UAAU,CAAE,UAAU,CAAEC,QAAQ,CAC9C,YAAY,CAAEyB,WAAW,CAAE,MAAM,CAAEE,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAEpF,GAAI,CAAAC,SAAS,CAAG,KAAM,CAAAxB,KAAK,oCAAqC,CAC5DC,WAAW,CAAE,SAAS,CACtBC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAG,CACN,QAAQ,CAAE,kBAAkB,CAC5B,cAAc,CAAE,kBAAkB,CAClC,eAAe,WAAAC,MAAA,CAAYkB,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC5D,CAAC,CACDzB,IAAI,CAAEO,IAAI,CAACC,SAAS,CAACR,IAAI,CAC7B,CAAC,CAAC,CAEF,GAAG0B,SAAS,CAACC,MAAM,EAAI,GAAG,CAAC,CACvB,KAAM,CAAA/C,cAAc,CAACgD,iBAAiB,CAAC,CAAC,CAExCF,SAAS,CAAG,KAAM,CAAAxB,KAAK,oCAAqC,CACxDC,WAAW,CAAE,SAAS,CACtBC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAG,CACN,QAAQ,CAAE,kBAAkB,CAC5B,cAAc,CAAE,kBAAkB,CAClC,eAAe,WAAAC,MAAA,CAAYkB,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC5D,CAAC,CACDzB,IAAI,CAAEO,IAAI,CAACC,SAAS,CAACR,IAAI,CAC7B,CAAC,CAAC,CACN,CAEA,GAAI,CAAAU,QAAQ,CAEZ,GAAGgB,SAAS,CAACC,MAAM,EAAI,GAAG,CAAC,KAAAE,qBAAA,CACvBnB,QAAQ,EAAAmB,qBAAA,CAAI,KAAM,CAAAH,SAAS,CAACjB,IAAI,CAAC,CAAC,UAAAoB,qBAAA,iBAAvBA,qBAAA,CAA0BnB,QAAQ,CAC7C,KAAM,CAAAC,KAAK,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAE5B,IAAI,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGU,YAAY,CAACT,MAAM,CAAED,CAAC,EAAE,CAAC,CACxCF,KAAK,CAACI,MAAM,CAAC,iBAAiB,CAAEQ,YAAY,CAACV,CAAC,CAAC,CAAC,CACpD,CAEA,KAAM,CAAAX,KAAK,qCAAAI,MAAA,CAAqCI,QAAQ,EAAG,CACvDN,MAAM,CAAE,KAAK,CACbJ,IAAI,CAAEW,KACV,CAAC,CAAC,CACN,CAEA,MAAO,CAAAD,QAAQ,CACnB,CAEA,KAAM,CAAAoB,uBAAuBA,CAAA,CAAE,CAC3B,KAAM,CAAAC,OAAO,CAAG,CAAC,kBAAkB,CAAE,yBAAyB,CAC1C,kBAAkB,CAAE,mBAAmB,CACvC,kBAAkB,CAAC,CACvC,MAAO,CAAAA,OAAO,CAClB,CAEA,KAAM,CAAAC,aAAaA,CAAA,CAAE,CACjB,KAAM,CAAAD,OAAO,CAAG,CAAC,2BAA2B,CAAE,uBAAuB,CACjD,iBAAiB,CAAE,mBAAmB,CACtC,iCAAiC,CAAE,qBAAqB,CACxD,sCAAsC,CAAC,CAC3D,MAAO,CAAAA,OAAO,CAClB,CAEA,KAAM,CAAAE,oBAAoBA,CAAA,CAAE,CACxB,KAAM,CAAAF,OAAO,CAAG,CAAC,MAAM,CAAE,OAAO,CAAE,UAAU,CAAC,CAC7C,MAAO,CAAAA,OAAO,CAClB,CAEA,KAAM,CAAAG,uBAAuBA,CAAA,CAAE,CAC3B,KAAM,CAAAH,OAAO,CAAG,CAAC,wBAAwB,CAAE,QAAQ,CAAE,iBAAiB,CAAE,OAAO,CAAE,gBAAgB,CAC7E,mBAAmB,CAAE,OAAO,CAAE,SAAS,CAAC,CAC5D,MAAO,CAAAA,OAAO,CAClB,CACJ,CAAC,CAED,KAAM,CAAAI,eAAe,CAAG,GAAI,CAAAtD,eAAe,CAAC,CAAC,CAE7C,cAAe,CAAAsD,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}