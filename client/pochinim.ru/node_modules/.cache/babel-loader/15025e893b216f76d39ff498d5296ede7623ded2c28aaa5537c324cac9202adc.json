{"ast":null,"code":"import userServices from \"../services/delete/user-services\";\nimport fetchServices from \"../services/fetch-services\";\nclass UserController {\n  async checkUserEmailInBd(email) {\n    //const ret = await userServices.checkEmail(email)\n    const ret = await fetchServices.fetchGETWithCredentials(`/users/check_email/${email}`);\n    return ret;\n  }\n  async registrate(email, login, password) {\n    //var ret = await userServices.registrate(name, email, password);\n    const body = {\n      \"login\": login,\n      \"password\": password,\n      \"email\": email\n    };\n    var ret = await fetchServices.fetchPOSTWithCredentials(`/users`, JSON.stringify(body));\n    localStorage.setItem('token', ret.accessToken);\n    localStorage.setItem('mail', email);\n    if (ret !== null && ret !== void 0 && ret.message) {\n      return false;\n    }\n    return true;\n  }\n  async getSendCode(email) {\n    //var code = await userServices.sendCode(email);\n    var code = await fetchServices.fetchGET(`/users/send_code/${email}`);\n    if (code !== null && code !== void 0 && code.message) {\n      return false;\n    }\n    return code;\n  }\n  async logInUser(email, password) {\n    //var ret = await userServices.logIn(email, password);\n    const body = {\n      'email': email,\n      'password': password\n    };\n    const ret = await fetchServices.fetchPOSTWithCredentials('/users/login', JSON.stringify(body));\n    localStorage.setItem('token', ret === null || ret === void 0 ? void 0 : ret.accessToken);\n    localStorage.setItem('mail', email);\n    console.log(ret);\n    if (ret !== null && ret !== void 0 && ret.message) {\n      return false;\n    }\n    return true;\n  }\n  async checkForAccess() {\n    if (localStorage.getItem('token')) {\n      //const ret = await userServices.checkAuth();\n      const ret = await fetchServices.fetchGETWithCredentials(`/refresh`);\n      //denisyakubov321@gmail.com\n      localStorage.setItem('token', ret.accessToken);\n      if (ret !== null && ret !== void 0 && ret.message) {\n        return false;\n      } else {\n        return true;\n      }\n    }\n    return false;\n  }\n  async logOutUser() {\n    //const ret = await userServices.logOut();\n    const ret = await fetchServices.fetchGETWithCredentials(`/users/logout`);\n    localStorage.removeItem('token');\n    localStorage.removeItem('mail');\n    if (ret !== null && ret !== void 0 && ret.message) {\n      return false;\n    }\n    return true;\n  }\n  async getUserInfo(email) {\n    //const ret = await userServices.getUserInfo(email);\n    const ret = await fetchServices.fetchGETWithCredentialsAndAuthorization(`/users/${email}`, localStorage.getItem('token'));\n    return ret;\n  }\n  async updateUserField(field, newValue, id_account) {\n    console.log(field + ' will be now: ' + newValue);\n    const body = {\n      'column_name': field,\n      'new_value': newValue,\n      'id_account': id_account\n    };\n    const ret = fetchServices.fetchPUT('/users', body);\n    return ret;\n  }\n  async getUserTopics(email) {\n    //const ret = await topicServices.getAllUserTopics(email);\n    const ret = await fetchServices.fetchGETWithCredentialsAndAuthorization(`/topics/${email}`, localStorage.getItem('token'));\n    console.log(ret);\n    return ret;\n  }\n}\nconst userController = new UserController();\nexport default userController;","map":{"version":3,"names":["userServices","fetchServices","UserController","checkUserEmailInBd","email","ret","fetchGETWithCredentials","registrate","login","password","body","fetchPOSTWithCredentials","JSON","stringify","localStorage","setItem","accessToken","message","getSendCode","code","fetchGET","logInUser","console","log","checkForAccess","getItem","logOutUser","removeItem","getUserInfo","fetchGETWithCredentialsAndAuthorization","updateUserField","field","newValue","id_account","fetchPUT","getUserTopics","userController"],"sources":["C:/Users/denis/VSCode_projects/Pochinim.ru/client/pochinim.ru/src/controllers/USER-controller.js"],"sourcesContent":["import userServices from \"../services/delete/user-services\";\r\nimport fetchServices from \"../services/fetch-services\";\r\n\r\nclass UserController{\r\n\r\n    async checkUserEmailInBd(email){\r\n        //const ret = await userServices.checkEmail(email)\r\n        const ret = await fetchServices.fetchGETWithCredentials(`/users/check_email/${email}`);\r\n        return ret;\r\n    }\r\n\r\n    async registrate(email, login, password){\r\n        //var ret = await userServices.registrate(name, email, password);\r\n        const body = {\"login\": login, \"password\": password, \"email\": email};\r\n\r\n        var ret = await fetchServices.fetchPOSTWithCredentials(`/users`, JSON.stringify(body));\r\n\r\n        localStorage.setItem('token', ret.accessToken);\r\n        localStorage.setItem('mail', email);\r\n\r\n        if(ret?.message){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async getSendCode(email){\r\n        //var code = await userServices.sendCode(email);\r\n        var code = await fetchServices.fetchGET(`/users/send_code/${email}`);\r\n\r\n        if(code?.message){\r\n            return false;\r\n        }\r\n        \r\n        return code;\r\n    }\r\n\r\n    async logInUser(email, password){\r\n        //var ret = await userServices.logIn(email, password);\r\n        const body = {'email': email, 'password': password};\r\n\r\n        const ret = await fetchServices.fetchPOSTWithCredentials('/users/login', JSON.stringify(body));\r\n        \r\n        localStorage.setItem('token', ret?.accessToken);\r\n        localStorage.setItem('mail', email);\r\n        console.log(ret);\r\n        if(ret?.message){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async checkForAccess(){\r\n        if(localStorage.getItem('token')){\r\n            //const ret = await userServices.checkAuth();\r\n            const ret = await fetchServices.fetchGETWithCredentials(`/refresh`);\r\n            //denisyakubov321@gmail.com\r\n            localStorage.setItem('token', ret.accessToken);\r\n\r\n            if(ret?.message){\r\n                return false;\r\n            }else{\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    async logOutUser(){\r\n        //const ret = await userServices.logOut();\r\n        const ret = await fetchServices.fetchGETWithCredentials(`/users/logout`);\r\n\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('mail');\r\n\r\n        if(ret?.message){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async getUserInfo(email){\r\n        //const ret = await userServices.getUserInfo(email);\r\n        const ret = await fetchServices.fetchGETWithCredentialsAndAuthorization(`/users/${email}`, localStorage.getItem('token'));\r\n\r\n        return ret;\r\n    }\r\n\r\n    async updateUserField(field, newValue, id_account){\r\n        console.log(field + ' will be now: ' + newValue);\r\n        const body = {'column_name': field, 'new_value': newValue, 'id_account': id_account};\r\n\r\n        const ret = fetchServices.fetchPUT('/users', body);\r\n \r\n        return ret;\r\n    }\r\n\r\n    async getUserTopics(email){\r\n        //const ret = await topicServices.getAllUserTopics(email);\r\n        const ret = await fetchServices.fetchGETWithCredentialsAndAuthorization(`/topics/${email}`, localStorage.getItem('token'));\r\n        console.log(ret);\r\n        return ret;\r\n    }\r\n}\r\n\r\nconst userController = new UserController();\r\n\r\nexport default userController;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}