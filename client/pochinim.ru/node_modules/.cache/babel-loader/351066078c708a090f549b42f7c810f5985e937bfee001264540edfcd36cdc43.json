{"ast":null,"code":"import{makeAutoObservable}from\"mobx\";class MasterController{constructor(){makeAutoObservable(this);}async checkMasterInBd(email){const data=await fetch(\"http://localhost:4000/api/masters/check_email/\".concat(email),{credentials:'include',method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});return await data.json();}async registrate(fio,occupation,workingFrom,location,selectedOptionsLocation,email,photo,password,city){var _await$ret$json;var selectedOptionsLocationStr=[];if(selectedOptionsLocation!=null){for(const obj of selectedOptionsLocation){selectedOptionsLocationStr.push(obj.label);}}const body={\"fio\":fio,\"occupation\":occupation,\"workingFrom\":workingFrom,\"location\":location,\"selectedOptionsLocation\":JSON.stringify(selectedOptionsLocationStr).replace('[','').replace(']',''),\"email\":email,\"password\":password,\"city\":city};const data=await fetch(\"http://localhost:4000/api/masters\",{method:\"POST\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},credentials:'include',body:JSON.stringify(body)});const master=await data.json();localStorage.setItem('token-master',master===null||master===void 0?void 0:master.accessToken);localStorage.setItem('mail-master',master===null||master===void 0?void 0:master.email);const file=new FormData();file.append('masterPhoto',photo);const ret=await fetch(\"http://localhost:4000/api/masters/\".concat(master===null||master===void 0?void 0:master.id_master),{method:\"PUT\",body:file});if(master!==null&&master!==void 0&&master.message||(_await$ret$json=await ret.json())!==null&&_await$ret$json!==void 0&&_await$ret$json.message){return false;}return true;}async logInMaster(email,password){const body={'email':email,'password':password};const data=await fetch(\"http://localhost:4000/api/masters/login\",{method:\"POST\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},credentials:'include',body:JSON.stringify(body)});const ret=await data.json();localStorage.setItem('token-master',ret===null||ret===void 0?void 0:ret.accessToken);localStorage.setItem('mail-master',email);if(ret!==null&&ret!==void 0&&ret.message){return false;}return true;}async logOutMaster(){const data=await fetch(\"http://localhost:4000/api/masters/logout\",{credentials:'include',method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});const ret=await data.json();localStorage.removeItem('token-master');localStorage.removeItem('mail-master');if(ret!==null&&ret!==void 0&&ret.message){return false;}return true;}async refreshMasterTokens(){if(localStorage.getItem('token-master')){const data=await fetch(\"http://localhost:4000/api/refresh-master\",{credentials:'include',method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});const ret=await data.json();localStorage.setItem('token-master',ret===null||ret===void 0?void 0:ret.accessToken);if(ret!==null&&ret!==void 0&&ret.message){return false;}else{return true;}}return false;}async getReviewsById(id){}async getWholeInfById(id){const data=await fetch(\"http://localhost:4000/api/masters/\".concat(id),{method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});return await data.json();}async getListOfMasters(from,to){const data=await fetch(\"http://localhost:4000/api/masters/\".concat(from,\"/\").concat(to),{method:\"GET\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"}});const masters=await data.json();return masters;}async getMasterPhotoByPath(path){const data=await fetch(\"http://localhost:4000/api/photos\",{method:\"POST\",headers:{\"Accept\":\"application/json\",\"Content-Type\":\"application/json\"},body:JSON.stringify({path:path})});const photo=await data.blob();const obj=URL.createObjectURL(photo);return obj;}};const masterController=new MasterController();export default masterController;","map":{"version":3,"names":["makeAutoObservable","MasterController","constructor","checkMasterInBd","email","data","fetch","concat","credentials","method","headers","json","registrate","fio","occupation","workingFrom","location","selectedOptionsLocation","photo","password","city","_await$ret$json","selectedOptionsLocationStr","obj","push","label","body","JSON","stringify","replace","master","localStorage","setItem","accessToken","file","FormData","append","ret","id_master","message","logInMaster","logOutMaster","removeItem","refreshMasterTokens","getItem","getReviewsById","id","getWholeInfById","getListOfMasters","from","to","masters","getMasterPhotoByPath","path","blob","URL","createObjectURL","masterController"],"sources":["C:/Users/denis/VSCode_projects/Pochinim.ru/client/pochinim.ru/src/controllers/MASTER-controller.js"],"sourcesContent":["import {makeAutoObservable} from \"mobx\"\r\nclass MasterController{\r\n    constructor(){\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    async checkMasterInBd(email){\r\n        const data = await fetch(`http://localhost:4000/api/masters/check_email/${email}`,{\r\n            credentials: 'include',\r\n            method: \"GET\",\r\n            headers: {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        });\r\n\r\n        return (await data.json());\r\n    }\r\n\r\n    async registrate(fio, occupation, workingFrom, location, selectedOptionsLocation, \r\n                        email, photo, password, city){\r\n\r\n        var selectedOptionsLocationStr = [];\r\n        \r\n        if (selectedOptionsLocation != null) {\r\n            for (const obj of selectedOptionsLocation){\r\n                selectedOptionsLocationStr.push(obj.label)\r\n            }\r\n        }\r\n\r\n        const body = {\"fio\": fio, \"occupation\": occupation, \"workingFrom\": workingFrom, \"location\": location,\r\n                        \"selectedOptionsLocation\": JSON.stringify(selectedOptionsLocationStr).replace('[', '').replace(']', ''),\r\n                            \"email\": email, \"password\": password, \"city\": city};\r\n\r\n        const data = await fetch(`http://localhost:4000/api/masters`,{\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            },  \r\n            credentials: 'include',\r\n            body: JSON.stringify(body)\r\n        });\r\n            \r\n        const master = await data.json();\r\n\r\n        localStorage.setItem('token-master', master?.accessToken);\r\n        localStorage.setItem('mail-master', master?.email);\r\n\r\n        const file = new FormData();\r\n        file.append('masterPhoto', photo);\r\n\r\n        const ret = await fetch(`http://localhost:4000/api/masters/${master?.id_master}`,{\r\n            method: \"PUT\",\r\n            body: file\r\n        });\r\n          \r\n        if(master?.message || (await ret.json())?.message){\r\n            return false;\r\n        }  \r\n        return true;\r\n    }\r\n\r\n    async logInMaster(email, password){\r\n        const body = {'email': email, 'password': password};\r\n\r\n        const data = await fetch(`http://localhost:4000/api/masters/login`,{\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            }, \r\n            credentials: 'include',\r\n            body: JSON.stringify(body)\r\n        });\r\n        \r\n        const ret = await data.json();\r\n\r\n        localStorage.setItem('token-master', ret?.accessToken);\r\n        localStorage.setItem('mail-master', email);\r\n        \r\n        if(ret?.message){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async logOutMaster(){\r\n        const data = await fetch(`http://localhost:4000/api/masters/logout`,{\r\n            credentials: 'include',\r\n            method: \"GET\",\r\n            headers: {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        });\r\n\r\n        const ret = await data.json();\r\n\r\n        localStorage.removeItem('token-master');\r\n        localStorage.removeItem('mail-master');\r\n\r\n        if(ret?.message){\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    async refreshMasterTokens(){\r\n        if(localStorage.getItem('token-master')){\r\n            const data = await fetch(`http://localhost:4000/api/refresh-master`,{\r\n                credentials: 'include',\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Accept\": \"application/json\",\r\n                    \"Content-Type\": \"application/json\"\r\n                }\r\n            });\r\n\r\n            const ret = await data.json();\r\n\r\n            localStorage.setItem('token-master', ret?.accessToken);\r\n\r\n            if(ret?.message){\r\n                return false;\r\n            }else{\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    async getReviewsById(id){\r\n        \r\n    }\r\n\r\n    async getWholeInfById(id){\r\n        const data = await fetch(`http://localhost:4000/api/masters/${id}`,{\r\n            method: \"GET\",\r\n            headers: {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        });\r\n\r\n        return (await data.json());\r\n    }\r\n\r\n    async getListOfMasters(from, to){\r\n        const data = await fetch(`http://localhost:4000/api/masters/${from}/${to}`,{\r\n            method: \"GET\",\r\n            headers: {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            }\r\n        });\r\n\r\n        const masters = await data.json();\r\n        \r\n        return masters;\r\n    }\r\n\r\n    async getMasterPhotoByPath(path){\r\n        const data = await fetch(`http://localhost:4000/api/photos`,{\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({ path: path })\r\n        })\r\n\r\n        const photo = await data.blob();\r\n\r\n        const obj = URL.createObjectURL(photo);\r\n\r\n        return obj;\r\n    }\r\n};\r\n\r\nconst masterController = new MasterController();\r\n\r\nexport default masterController;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}